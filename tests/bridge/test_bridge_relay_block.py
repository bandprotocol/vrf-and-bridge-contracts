import brownie


def test_bridge_relayBlock_success(simplebridge):
    simplebridge.relayBlock(
        [
            "0x5248463E932D16F7D092E268C0DED87B23D3B0E71856F1C6AE2AA91F6C713320",
            "0x7FD5F5C7C2920C187618542901CDC5717BE8204F24BE856E80902A1BB04737E4",
            "0xF981716562A49DE06E3DCAFBFB6388C294BAA4FA9D45777E25740A92F81CF65E",
            "0xE8E27CBB44BB654F64EEEF4667868AD48667CEB28E3DB5C4DF7A4B4B87F0C04B",
            "0xFC96CFFD30E5B8979EA66F9D0DA1CBAB16F69669E8B2A1FB2E1BEB457C9726E8",
            "0xC9C8849ED125CC7681329C4D27B83B1FC8ACF7A865C9D1D1DF575CCA56F48DBE",
        ],
        [
            "0x3F02642D9E70D5C1C493A4F732BFE9C9B95A4A42651703B816EDCFC8FADA5312",  # versionAndChainIdHash
            25000,  # height
            1629849931,  # timeSecond
            290650376,  # timeNanoSecond
            "0x9B4825C99C3E739E1DC171FFB0E2BF34E99EEE41B34E407E40CF594834427B09",  # lastBlockIDAndOther
            "0xBF23413F237906B07202B3355E7311651ACE6BD2A34FD6FC3BD98EFE4FB78755",  # nextValidatorHashAndConsensusHash
            "0x9FB9C7533CAF1D218DA3AF6D277F6B101C42E3C3B75D784242DA663604DD53C2",  # lastResultsHash
            "0x7D11A74E40884411901BD7A70631734990B1FDBF5DE9E4C92C63B7650A6A6659",  # evidenceAndProposerHash
        ],
        [
            "0x080211A86100000000000022480A20",
            "0x1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A6301",
        ],
        [
            [
                "0x84B8585B71240FEE0E674952B79ED25D793F1B31B42DD37B80F75B98510B5754",
                "0x1EC44DD7C5389474DF8E5C25CC6ED8B573CCA2E009AA824EE825BDC693935927",
                28,
                "0x08CD9296890610EAE9963D",
            ],
            [
                "0x394365193F819CF539381366D31B6C5849AAA31AE8BA6F95C62C5C80656BFB5C",
                "0x6A07E4A3C0ABCEAE5F854D492DF699438FB84762F152F739DDEAC48DDCFCB5CC",
                28,
                "0x08CD9296890610EA928633",
            ],
            [
                "0x5D7B4BE7B21B00D08AD7DBE48CF2761CECCB599E64AAB10B2901A0DD58F00325",
                "0x7160EF689A533C1E983707507FC8466DAEA1D0DC7A889E3A27D1BB1D09CEC030",
                28,
                "0x08CD929689061086FAB239",
            ],
            [
                "0x5654A44FB89330C34CF2D862F940763194A145B72ED3BB0ADD5759E1E68FD145",
                "0x2AC795D02A9C574CF12343FDFC67FDCED8A24F88EC8138C7F8230F6EB442B726",
                28,
                "0x08CD9296890610F0E1F733",
            ],
        ],
    )


def test_bridge_relayBlock_insufficient_validator(simplebridge):
    with brownie.reverts("INSUFFICIENT_VALIDATOR_SIGNATURES"):
        tx = simplebridge.relayBlock(
            [
                "0x94FE4A060FCF744C5BFCE1155CF1AB99B386F9170BC1C0105060994AEBEDE65C",
                "0x7FD5F5C7C2920C187618542901CDC5717BE8204F24BE856E80902A1BB04737E4",
                "0xF981716562A49DE06E3DCAFBFB6388C294BAA4FA9D45777E25740A92F81CF65E",
                "0xE8E27CBB44BB654F64EEEF4667868AD48667CEB28E3DB5C4DF7A4B4B87F0C04B",
                "0xFC96CFFD30E5B8979EA66F9D0DA1CBAB16F69669E8B2A1FB2E1BEB457C9726E8",
                "0xC9C8849ED125CC7681329C4D27B83B1FC8ACF7A865C9D1D1DF575CCA56F48DBE",
            ],
            [
                "0x3F02642D9E70D5C1C493A4F732BFE9C9B95A4A42651703B816EDCFC8FADA5312",  # versionAndChainIdHash
                25000,  # height
                1629849931,  # timeSecond
                290650376,  # timeNanoSecond
                "0x9B4825C99C3E739E1DC171FFB0E2BF34E99EEE41B34E407E40CF594834427B09",  # lastBlockIDAndOther
                "0xBF23413F237906B07202B3355E7311651ACE6BD2A34FD6FC3BD98EFE4FB78755",  # nextValidatorHashAndConsensusHash
                "0x9FB9C7533CAF1D218DA3AF6D277F6B101C42E3C3B75D784242DA663604DD53C2",  # lastResultsHash
                "0x7D11A74E40884411901BD7A70631734990B1FDBF5DE9E4C92C63B7650A6A6659",  # evidenceAndProposerHash
            ],
            [
                "0x080211A86100000000000022480A20",
                "0x1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A6301",
            ],
            [
                [
                    "0x84B8585B71240FEE0E674952B79ED25D793F1B31B42DD37B80F75B98510B5754",
                    "0x1EC44DD7C5389474DF8E5C25CC6ED8B573CCA2E009AA824EE825BDC693935927",
                    28,
                    "0x08CD9296890610EAE9963D",
                ],
                [
                    "0x394365193F819CF539381366D31B6C5849AAA31AE8BA6F95C62C5C80656BFB5C",
                    "0x6A07E4A3C0ABCEAE5F854D492DF699438FB84762F152F739DDEAC48DDCFCB5CC",
                    28,
                    "0x08CD9296890610EA928633",
                ],
            ],
        )
        assert tx.status == 0


def test_bridge_relayBlock_invalid_signature_order(simplebridge):
    with brownie.reverts("INVALID_SIGNATURE_SIGNER_ORDER"):
        tx = simplebridge.relayBlock(
            [
                "0x94FE4A060FCF744C5BFCE1155CF1AB99B386F9170BC1C0105060994AEBEDE65C",
                "0x7FD5F5C7C2920C187618542901CDC5717BE8204F24BE856E80902A1BB04737E4",
                "0xF981716562A49DE06E3DCAFBFB6388C294BAA4FA9D45777E25740A92F81CF65E",
                "0xE8E27CBB44BB654F64EEEF4667868AD48667CEB28E3DB5C4DF7A4B4B87F0C04B",
                "0xFC96CFFD30E5B8979EA66F9D0DA1CBAB16F69669E8B2A1FB2E1BEB457C9726E8",
                "0xC9C8849ED125CC7681329C4D27B83B1FC8ACF7A865C9D1D1DF575CCA56F48DBE",
            ],
            [
                "0x3F02642D9E70D5C1C493A4F732BFE9C9B95A4A42651703B816EDCFC8FADA5312",  # versionAndChainIdHash
                25000,  # height
                1629849931,  # timeSecond
                290650376,  # timeNanoSecond
                "0x9B4825C99C3E739E1DC171FFB0E2BF34E99EEE41B34E407E40CF594834427B09",  # lastBlockIDAndOther
                "0xBF23413F237906B07202B3355E7311651ACE6BD2A34FD6FC3BD98EFE4FB78755",  # nextValidatorHashAndConsensusHash
                "0x9FB9C7533CAF1D218DA3AF6D277F6B101C42E3C3B75D784242DA663604DD53C2",  # lastResultsHash
                "0x7D11A74E40884411901BD7A70631734990B1FDBF5DE9E4C92C63B7650A6A6659",  # evidenceAndProposerHash
            ],
            [
                "0x080211A86100000000000022480A20",
                "0x1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A6301",
            ],
            [
                [
                    "0x394365193F819CF539381366D31B6C5849AAA31AE8BA6F95C62C5C80656BFB5C",
                    "0x6A07E4A3C0ABCEAE5F854D492DF699438FB84762F152F739DDEAC48DDCFCB5CC",
                    28,
                    "0x08CD9296890610EA928633",
                ],
                [
                    "0x5D7B4BE7B21B00D08AD7DBE48CF2761CECCB599E64AAB10B2901A0DD58F00325",
                    "0x7160EF689A533C1E983707507FC8466DAEA1D0DC7A889E3A27D1BB1D09CEC030",
                    28,
                    "0x08CD929689061086FAB239",
                ],
                [
                    "0x5654A44FB89330C34CF2D862F940763194A145B72ED3BB0ADD5759E1E68FD145",
                    "0x2AC795D02A9C574CF12343FDFC67FDCED8A24F88EC8138C7F8230F6EB442B726",
                    28,
                    "0x08CD9296890610F0E1F733",
                ],
                [
                    "0x84B8585B71240FEE0E674952B79ED25D793F1B31B42DD37B80F75B98510B5754",
                    "0x1EC44DD7C5389474DF8E5C25CC6ED8B573CCA2E009AA824EE825BDC693935927",
                    28,
                    "0x08CD9296890610EAE9963D",
                ],
            ],
        )
        assert tx.status == 0
